#!/bin/sh

# Commit message format checker
# Ensures commit messages follow Conventional Commits specification

commit_msg_file="$1"
commit_msg=$(cat "$commit_msg_file")

# Conventional Commits pattern
conventional_pattern="^(build|chore|ci|docs|feat|fix|perf|refactor|revert|style|test)(\([a-z0-9-]+\))?: .+$"

# Check if the commit message follows the pattern
if ! echo "$commit_msg" | grep -qE "$conventional_pattern"; then
    echo "Error: Commit message format is incorrect."
    echo "Please use the Conventional Commits format:"
    echo "type(scope): description"
    echo ""
    echo "Types: build|chore|ci|docs|feat|fix|perf|refactor|revert|style|test"
    echo "Example: feat(auth): add JWT authentication"
    exit 1
fi

# Check message length
if [ ${#commit_msg} -gt 72 ]; then
    echo "Error: Commit message is too long (max 72 characters)."
    exit 1
fi

exit 0
